(function($,window,document){var version="3.0";$.extend($.fn,{taiji:function(opts){if(!this.length){if(window.console&&window.console.warn){window.console.warn("没有选择任何节点，直接返回");}return;}var aTaiji=$(this).data("aTaiji");if(aTaiji){return this;}aTaiji=new $.Taiji(opts,this);$(this).data("aTaiji",aTaiji);$(window).resize(function(){aTaiji.repostion();});$(document).scroll(function(){aTaiji.repostion();});return this;}});$.Taiji=function(opts,targetDiv){this.settings=$.extend(true,{},$.Taiji.defaults,opts);this.currentTarget=$(targetDiv);this.base64=new Base64();this.isRunning=false;this.decode=this.base64.decode;this.aclCheck($(this.settings.aclClassName,this.currentTarget));this.repostion();this.searchFormClassName=this.settings.search.formClassName;this.searchSubmitClassName=this.settings.search.submitClassName;this.searchResetClassName=this.settings.search.resetClassName;this.searchAutoRefreshEnable=this.settings.search.autoRefresh.enable;this.searchAutoRefreshInterval=this.settings.search.autoRefresh.interval;
this._init();};$.extend($.Taiji,{prototype:{_init:function(){$(this.currentTarget).addClass("_taiji_");this._bindSearchSubmitClick();this._bindSearchResetClick();this._bindSerachFormValidate();this._bindSearchFormInputEnter();this._bindAll();if(this.settings.search.autoSearch===true){$(this.searchFormClassName,this.currentTarget).trigger("submit");}else{$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody").empty().append("<tr><td colspan='15' ><div class='taiji_not_found'>请先填写查询条件！</div></td></tr>");}},_bindAll:function(){var $self=(this),events={},classNames={},$target=$(this.currentTarget);$.each($.Taiji.events,function(event,coll){if(!events[event]){events[event]={};}$.each(coll,function(name,other){$.each(other,function(cn,handler){var className=$self.settings[name][cn];events[event][className]=handler;});});});$.each(events,function(aEvent,cllol){$target.off(aEvent+".taiji").on(aEvent+".taiji",function(event){var $target=($(event.target).is("a")||$(event.target).is(":checkbox")||$(event.target).is("th"))?$(event.target):($(event.target).parents().is("a")&&$(event.target).parents("a"))?$(event.target).parents("a"):$self._emptyTarget;
$.each(cllol,function(className,handler){if($target.is(className)){$self[handler]($target);$.Taiji.preventDefault(event);}});});});$.each($.Taiji.customEvents,function(name,handler){$target.off(name).on(name,function(event,form,options){$self[handler](form,options);});});},_emptyTarget:{is:function(className){return false;}},_bindSearchFormInputEnter:function(){var $self=this;$(this.searchFormClassName,this.currentTarget).find(":input:text").keydown(function(event){var $target=$(event.target);if(event.keyCode===13){$($self.searchSubmitClassName,$self.currentTarget).trigger("click");}});},_bindSerachFormValidate:function(){var $this=this;if($.fn.validate){this.searchFormValidate=$(this.searchFormClassName,this.currentTarget).validate({rules:$this.settings.search.rules||{},messages:$this.settings.search.messages||{},submitHandler:function(form){$this._search(form);}});}else{$(this.searchFormClassName,this.currentTarget).on("submit",function(event){$this._search($(this));$.Taiji.preventDefault(event);
});}},_bindSearchSubmitClick:function(){var $this=this;$(this.searchSubmitClassName,this.currentTarget).click(function(event){$($this.searchFormClassName,$this.currentTarget).trigger("submit");$.Taiji.preventDefault(event);});},_bindSearchResetClick:function(){var $this=this;$(this.searchResetClassName,this.currentTarget).click(function(event){$($this.searchFormClassName,$this.currentTarget).trigger("reset");$.Taiji.preventDefault(event);});},_search:function(form){if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}var $this=this,options={success:function success(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$.Taiji.hideLoading();$($this.searchSubmitClassName,$this.currentTarget).attr("disabled",false);
$this.isRunning=false;if(responseHeader.note){$this.warn("查询成功:"+$this.decode(responseHeader.note));}else{if(responseHeader.jme){$this.warn("查询失败:"+$this.decode(responseHeader.jme));}else{if(responseHeader.me){$this.warn("查询失败:"+$this.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(responseText).find("#taiji_ejson");$this.validationTip(ejson,$this.currentTarget);}else{$this._handleSearchSuccess(responseText);}}}}},error:function error(xhr){$this._handleOperateError(xhr.status,$($this.searchSubmitClassName,$this.currentTarget));}};$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);$(this.searchSubmitClassName,this.currentTarget).attr("disabled",true);$(this.searchFormClassName,this.currentTarget).ajaxSubmit(options);},_handleSearchSuccess:function(responseText){var $responseText=$(responseText);this._bindPager($responseText.find("#taiji_search_pager"));var hasText=$responseText.find("#taiji_search_data tbody").children().size()>0;if(hasText===true){var $tbody=$responseText.find("#taiji_search_data tbody");
this.aclCheck($tbody);var $trs,trsIndex=0,$myBody;$myBody=$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody");$myBody.empty().append($tbody.html());}else{$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody").empty().append("<tr><td colspan='15' ><div class='taiji_not_found'>没有检索到符合条件的数据！</div></td></tr>");}this._bindDataChange();var $$this=this;if(this.searchAutoRefreshEnable===true){if(this.taijiSearchTimeoutId){window.clearTimeout(this.taijiSearchTimeoutId);}this.taijiSearchTimeoutId=window.setTimeout(function(){$($$this.searchSubmitClassName,$$this.currentTarget).triggerHandler("click");},$$this.searchAutoRefreshInterval);}$(this.currentTarget).triggerHandler("taijiSearchSuccess",[responseText]);},_bindDataChange:function(){$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody > tr").off("click.taiji").on("click.taiji",function(event){$(this).addClass("taiji_clicked").siblings().removeClass("taiji_clicked");
});},_bindPager:function($searchPager){var $this=this,pageNo=window.parseInt($searchPager.find("#taiji_search_pageNo").text(),10),pageCount=window.parseInt($searchPager.find("#taiji_search_pagecount").text(),10),totalCount=window.parseInt($searchPager.find("#taiji_search_totalcount").text(),10);if(isNaN(pageCount)||pageCount<2||isNaN(pageNo)||pageNo<1||isNaN(totalCount)||totalCount<=0){$(".taiji_pager",this.currentTarget).hide();$(".taiji_pager_go",$this.currentTarget).hide();}else{$(".taiji_pager",this.currentTarget).each(function(){var $ul=$("<ul  class='pagination  m-t-0' ></ul>");var $li_total_record=$("<li ><span>共<strong class='totalCount'>"+totalCount+"</strong>条/<strong>"+pageCount+"</strong>页</span></li>").appendTo($ul);var $li_prev=$("<li ><a href='#' class='taiji_pager_item' value='"+(pageNo-1)+"'>&lt;</a></li>").appendTo($ul);if(pageNo===1){$li_prev.addClass("disabled").find("a").removeClass("taiji_pager_item");}var startPoint=1,endPoint=5;if(pageNo>3){startPoint=pageNo-2;endPoint=pageNo+2;
}if(endPoint>pageCount){startPoint=pageCount-4;endPoint=pageCount;}if(startPoint<1){startPoint=1;}for(var point=startPoint;point<=endPoint;point++){var $li_point=$("<li ><a href='#' class='taiji_pager_item' value='"+point+"'>"+point+"</a></li>").appendTo($ul);if(point===pageNo){$li_point.addClass("active").find("a").removeClass("taiji_pager_item");}}var $li_next=$("<li ><a href='#' class='taiji_pager_item' value='"+(pageNo+1)+"'>&gt;</a></li>").appendTo($ul);if(pageNo===pageCount){$li_next.addClass("disabled").find("a").removeClass("taiji_pager_item");}var $pager_input=$('<li><span class="input">到<input type="text" style="width:40px" value="100" class="taiji_pager_input">页</span><a class="taiji_pager_goto" href="#">跳转</a></li>').appendTo($ul);$(this).html($ul);}).show();$(".taiji_pager_input",$this.currentTarget).val(pageNo);$(".taiji_pager_go",$this.currentTarget).show();}},_handleOperateError:function(statusCode,obj){var $this=$(obj),showMessage=$.Taiji.Messages.ERR_RESPONSE+statusCode;
$.Taiji.showWarn(showMessage);this.warn(showMessage);$this.attr("disabled",false);$.Taiji.hideLoading();this.isRunning=false;},aclCheck:function(obj){if(!this.settings.enableAclCheck){return;}var $obj=$(obj);var uris;if($obj.is(this.settings.aclClassName)){uris=$obj;}else{uris=$obj.find(this.settings.aclClassName);}var pathName=window.location.pathname;var rootUrl=pathName.substr(0,pathName.substr(1).indexOf("/")+1)+"/";var hrefs=uris.map(function(){return $(this).attr("href").replace(rootUrl,"");}).get().join(",");$.ajax({type:"POST",url:rootUrl+"app/acl/hasbuttons",data:"uris="+hrefs,async:false,dataType:"json",success:function(list){$.each(list,function(i,n){if(!n.hasButton){uris.filter("[href='"+rootUrl+n.uri+"']").hide();}});}});},_handleBsSuccess:function(responseText,note,table){var $row=$(responseText).find(".taiji_result_data tr");this.aclCheck($row);if(table=="add"){var $tbody=$(this.settings.search.resultClassName,this.currentTarget).find("> table > tbody");$tbody.find(".taiji_clicked").removeClass("taiji_clicked");
$tbody.prepend($row.addClass("taiji_clicked"));}else{if(table=="edit"||table=="update"){$(this.settings.search.resultClassName,this.currentTarget).find(".taiji_clicked").replaceWith($row.addClass("taiji_clicked"));}else{if(table=="remove"){$(this.settings.search.resultClassName,this.currentTarget).find(".taiji_clicked").remove();}}}var operateObj={add:{event:"taijiAddSuccess",plus:1},edit:{event:"taijiEditSuccess",plus:0},update:{event:"taijiUpdateSuccess",plus:0},remove:{event:"taijiRemoveSuccess",plus:-1}};$(".taiji_pager .totalCount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)+operateObj[table].plus);});this._bindDataChange();$.Taiji.showNote(note);$(this.currentTarget).triggerHandler(operateObj[table].event,[responseText]);},validationTip:function(ejson,parent){var ejsonContent=$.parseJSON($(ejson).html());$.each(ejsonContent,function(i,n){var eles=$("[name='"+i+"']",parent);if(eles.length>1){$("div[data-for='"+i+"']",parent).tjPopover(n);}else{$("[name='"+i+"']",parent).tjPopover(n);
}});},ajaxHref:function(element,opts){var $element=$(element);var $url=$.Taiji.getUrl(element);if(!$url){$.Taiji.showWarn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($element);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$element.attr("disabled",true);$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);var that=this,dataObj={},defaults={method:"GET",bsSuccess:function(){},complete:function(){}};var options=$.extend({},defaults,opts);if($element.data("selector")){options.method="POST";$($element.data("selector")).each(function(){var e=$(this);if(e.attr("name")&&e.val()){dataObj[e.attr("name")]=e.val();}});}$.ajax({type:options.method,url:$url,data:dataObj,success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
if(responseHeader.jme){$.Taiji.showWarn(that.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(that.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(responseText).find("#taiji_ejson");that.validationTip(ejson,that.currentTarget);$.Taiji.showWarn($.Taiji.Messages.ERR_CVE);}else{options.bsSuccess.call(that,responseText,responseHeader.note&&that.decode(responseHeader.note));}}}that.isRunning=false;$.Taiji.hideLoading();},error:function(xhr){that.isRunning=false;$.Taiji.hideLoading();$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);},complete:function(xhr){$element.attr("disabled",false);options.complete.call(that,xhr);}});},ajaxForm:function(form,options){if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);var that=this,$form=$(form),settings={success:function(data,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$.Taiji.hideLoading();that.isRunning=false;if(responseHeader.note){options.bsSuccess.call(that,data,that.decode(responseHeader.note));}else{if(responseHeader.jme){$.Taiji.showWarn(that.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(that.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(data).find("#taiji_ejson");that.validationTip(ejson,form);$.Taiji.showWarn($.Taiji.Messages.ERR_CVE);}else{$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE);}}}}},error:function(xhr){$.Taiji.hideLoading();$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);that.isRunnig=false;},dataType:"html",forceSync:true};$.extend(settings,options);var $files=$(":file",$form);if($files.size()===0){$(form).removeProp("enctype");}else{var filesSize=$files.size();$files.each(function(){if(!$(this).val()){filesSize--;$(this).attr("disabled",true);}});if(filesSize===0){$(form).removeProp("enctype");}else{$(form).prop("enctype","multipart/form-data");}}$(form).ajaxSubmit(settings);
$(":file",$form).each(function(){$(this).attr("disabled",false);});},log:function(msg){if(this.settings.debug===true&&window.console&&window.console.warn){window.console.warn(msg);}},warn:function(msg){if(this.settings.debug===true&&window.console&&window.console.log){window.console.log(msg);}},repostion:function(){this.$windowW=$(window).width();this.$windowH=$(window).height();this.$sw=$(document).scrollLeft();this.$sh=$(document).scrollTop();}}});$.extend($.Taiji,{extendMethod:function(aExtendMethod){$.Taiji.defaults[aExtendMethod.name]=aExtendMethod.config;$.each(aExtendMethod.event,function(event,coll){if(!$.Taiji.events[event]){$.Taiji.events[event]={};}if(!$.Taiji.events[event][aExtendMethod.name]){$.Taiji.events[event][aExtendMethod.name]={};}if(coll){$.each(coll,function(className,handler){$.Taiji.log("事件："+event+",插件："+aExtendMethod.name+"，class:"+className+",处理函数:"+handler);$.Taiji.events[event][aExtendMethod.name][className]=handler;});}});if(aExtendMethod.customEvent){$.each(aExtendMethod.customEvent,function(i,event){$.Taiji.customEvents[i]=event;
});}$.each(aExtendMethod.eventHandler,function(i,handler){$.Taiji.prototype[i]=handler;});},events:{},customEvents:{},Constans:{RESPONSE_HEADER_NOTE:"taiji_note",RESPONSE_HEADER_JME:"taiji_jme",RESPONSE_HEADER_ME:"taiji_me",RESPONSE_HEADER_CVE:"taiji_cve"},preventDefault:function(event){if(event.preventDefault){event.preventDefault();}else{event.returnValue=false;}},Messages:{ERR_CVE:"校验失败，请看相关字段提示!",ERR_RESPONSE:"服务器返回了非预期的值，请联系技术人员，代码:",WAR_NOTNODE:"未选中任何节点！",WAR_OPERATE:"前一次操作尚未完成，请稍候！",MSG_OPERATE:"操作进行中，请稍候！"},getUrl:function(obj){var $obj=$(obj);return $obj&&$obj.is("a")&&$obj.attr("href");},getConfirmMessage:function(obj){var $obj=$(obj);return $.metadata&&$obj.metadata().confirm_message?$obj.metadata().confirm_message:$obj.attr("confirm_message");},log:function(msg){if(window.console&&window.console.log){window.console.log(msg);}},showLoading:function(message){this.log("[_createLoading]"+message);$loadingDiv=$("#alert-loading");if(!$loadingDiv.length){var html='<div id="alert-loading" class="alert alert-info  ">'+"<strong></strong>"+'<div  class="fade in"><span class="spinner"></span></div>'+"</div>";
$loadingDiv=$(html).prependTo(document.body);}$loadingDiv.find("strong").text(message).end().fadeIn(10);},hideLoading:function(){$("#alert-loading").fadeOut(10);},showWarn:function(message){if(typeof message!=="string"){this.log("[_showWarn] 非字符串无法显示");}var $warnDiv=$("#alert-info");if(!$warnDiv.length){var html='<div id="alert-info" class="alert alert-info  ">'+'<i class="fa fa-info-circle  fa-2x"></i>'+"<strong></strong>"+"</div>";$warnDiv=$(html).prependTo(document.body);}$warnDiv.find("strong").text(message).end().fadeIn(500).delay(2000).fadeOut(500);},showNote:function(message){if(typeof message!=="string"){this.log("[_showWarn] 非字符串无法显示");}var $noteDiv=$("#alert-success");if(!$noteDiv.length){var html='<div id="alert-success" class="alert alert-success  ">'+'<i class="fa fa-check-circle fa-2x "></i>'+"<strong></strong>"+"</div>";$noteDiv=$(html).prependTo(document.body);}$noteDiv.find("strong").text(message).end().fadeIn(500).delay(2000).fadeOut(500);},defaults:{search:{formClassName:".taiji_search_form",rules:{},messages:{},submitClassName:".taiji_search_submit",resetClassName:".taiji_search_reset",resultClassName:".taiji_search_result",dataClassName:".taiji_search_data",pagerClassName:".taiji_search_pager",autoRefresh:{enable:false,interval:60000},autoSearch:true},errorElement:"label",errorClass:"taiji_error",aclClassName:".taiji_acl",enableAclCheck:false,debug:true}});
$.Taiji.base64=new Base64();})(jQuery,window,document);(function($){$.Taiji.extendMethod({name:"pager",event:{click:{"className":"_handlePagerClick","gotoClassName":"_handleGotoClick"}},eventHandler:{_handlePagerClick:function(element){var pageclickednumber=$(element).attr("value");this._handlePageClick(pageclickednumber);},_handlePageClick:function(pageclickednumber){var $pageNo=$("input[name='pageNo']",this.currentTarget);if($pageNo.attr("name")){$pageNo.val(pageclickednumber);}else{$pageNo=$("<input type='hidden' id='pageNo' name='pageNo'/>").val(pageclickednumber).appendTo($(this.searchFormClassName,this.currentTarget));}$(this.searchFormClassName,this.currentTarget).trigger("submit");},_handleGotoClick:function(element){var $ele=$(element);var $pageNo=$ele.parent().find(".taiji_pager_input");if($pageNo.is(".taiji_pager_input")){var clickValue=$.trim($pageNo.val());if(!clickValue){$.Taiji.showWarn("请填写跳转页数");return;}if(!/^\d+$/.test(clickValue)){$.Taiji.showWarn("请填写数字");return;}var pageclickednumber=parseInt(clickValue,10);
if(pageclickednumber>100000){$.Taiji.showWarn("页数太大，请重新填写");return;}this._handlePageClick(pageclickednumber);}else{this.warn("没有name为pageNo的input框");}}},config:{className:".taiji_pager_item",gotoClassName:".taiji_pager_goto"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"multiCore",event:{change:{"checkAll":"_handleMultiCoreCheckAll"}},eventHandler:{_handleMultiCoreCheckAll:function(element){if($(element).is(":checked")){$(this.settings.multiCore.checkAll,this.currentTarget).attr("checked",true);$(this.settings.multiCore.checkOne,this.currentTarget).attr("checked",true);}else{$(this.settings.multiCore.checkAll,this.currentTarget).attr("checked",false);$(this.settings.multiCore.checkOne,this.currentTarget).attr("checked",false);}}},config:{checkAll:".taiji_check_all",checkOne:".taiji_check_one"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"modal",event:{click:{"modalDefault":"_handleDefaultModal","modalLage":"_handleLageModal","modalSmall":"_handleSmallModal","modalFull":"_handleFullModal"}},customEvent:{"taijiModalPost":"_handleModalPost"},eventHandler:{_handleDefaultModal:function(element){this._handleModal(element,"");
},_handleLageModal:function(element){this._handleModal(element,"modal-lg");},_handleSmallModal:function(element){this._handleModal(element,"modal-sm");},_handleFullModal:function(element){this._handleModal(element,"modal-message");},_handleModal:function(element,size){if(this.isRunning===true){return;}else{this.isRunning=true;}$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);var $this=this;$(element).showModal({"size":size,complete:function(){$this.isRunning=false;$.Taiji.hideLoading();}});},_handleModalPost:function(form,opts){var myOpts={table:"add",bsSuccess:function(responseText,note){this._handleBsSuccess(responseText,note,options.table);$().hideModal();}};var options=$.extend(myOpts,opts);this.ajaxForm(form,options);}},config:{modalDefault:".taiji_modal",modalLage:".taiji_modal_lg",modalSmall:".taiji_modal_sm",modalFull:".taiji_modal_full"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"open",event:{},customEvent:{"taijiOpenPost":"_handleOpenPost"},eventHandler:{_handleOpenPost:function(form,opts){var myOpts={table:"add",bsSuccess:function(responseText,note){opener.$(opts.openerTarget).data("aTaiji")._handleBsSuccess(responseText,note,options.table);
window.close();}};var options=$.extend(myOpts,opts);this.ajaxForm(form,options);}},config:{}});})(jQuery);(function($){$.extend({autocompleteAll:function(){var alls=$(".taiji_autocomplete:visible:not(._taiji_autocomplete)"),remotes=[],locals=[];$(alls).each(function(){if($(this).is("[data-url]")){remotes.push($(this));}else{locals.push($(this));}});$.autocompleteRemote(remotes);$.autocompleteLocal(locals);},autocompleteRemote:function(elems){$(elems).each(function(){var url=$(this).attr("data-url");var that=$(this);var key=that.attr("name");that.ajaxChosen({type:"POST",url:url,dataType:"json",minTermLength:1,afterTypeDelay:1000,jsonTermKey:key},function(data){var terms={};$.each(data,function(i,val){terms[val.id]=val.label;});return terms;}).addClass("_taiji_autocomplete");});},autocompleteLocal:function(elems){$(elems).each(function(){$(this).chosen({no_results_text:"没有匹配的选项!",search_contains:true}).addClass("_taiji_autocomplete");});}});})(jQuery);jQuery(function(){jQuery.autocompleteAll();
});(function($){$.Taiji.extendMethod({name:"download",event:{click:{"className":"_handleDownloadClick"}},eventHandler:{_handleDownloadClick:function(elment){var $this=$(elment);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){$$this.isRunning=false;if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE)){window.open($url);}else{if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME)){$.Taiji.showWarn($$this.decode(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME)));}else{if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME)){$.Taiji.showWarn($$this.decode(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME)));}else{if(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)){$.Taiji.showWarn($$this.decode(xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)));
}else{$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE,xhr.status);}}}}$.Taiji.hideLoading();$this.attr("disabled",false);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindDownload:function(){var $$this=this;$(this.settings.download.className,this.currentTarget).off("click.taiji").on("click.taiji",function(){$$this._handleDownloadClick(this);});}},config:{className:".taiji_download",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"exported",event:{click:{"className":"_handleExportedClick"}},eventHandler:{_handleExportedClick:function(element){var $$this=this;var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn("没有找到导出的URL..");return;}var query="";$(this.settings.search.formClassName,$$this.currentTarget).find(":input").each(function(){query+=$(this).attr("name");query+="=";query+=$(this).val();query+="&";});$(this.settings.search.formClassName,$$this.currentTarget).find(":selected").each(function(){query+=$(this).attr("name");
query+="=";query+=$(this).val();query+="&";});if($url.indexOf("?")>-1){query="&"+query;}else{query="?"+query;}$url+=encodeURI(query);if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return false;}else{$$this.isRunning=true;}$this.attr("disabled",true);$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);$.ajax({url:$url,type:"GET",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handleExportedSuccess(xhr.status,responseHeader,responseText,$this,$url);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}});},_handleExportedSuccess:function(status,responseHeader,responseText,obj,url){var $this=$(obj);$this.attr("disabled",false);$.Taiji.hideLoading();if(responseHeader.note){window.open(url,"_self");
}else{if(responseHeader.jme){$.Taiji.showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){$.Taiji.showWarn(this.decode(responseHeader.cve));}else{this.warn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);$.Taiji.showWarn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);}}}}this.isRunning=false;}},config:{className:".taiji_exported",includeAll:false,includeFields:[],rules:{}}});})(jQuery);(function($){$.extend($.Taiji,{taijiJump:function(form,button,options){var $button=$(button);$.holdReady(true);$button.attr("disabled",true);$.Taiji.createLoading($.Taiji.Messages.MSG_OPERATE);var $form=$(form),settings={success:function(data,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$.Taiji.hideLoading();
if(responseHeader.note){$.Taiji.showNote($.Taiji.base64.decode(responseHeader.note));var noteHead=$("head")[0];var si=data.indexOf("<script");var sdd=data.substr(si);var siii=data.indexOf(">",si);var ei=data.indexOf("</",siii);var sd=data.substr(siii+1,ei-siii-1);var noteScript=document.createElement("script");noteHead.appendChild(noteScript);noteScript.innerHTML=sd;}else{if(responseHeader.jme){$.Taiji.showWarn($.Taiji.base64.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn($.Taiji.base64.decode(responseHeader.me));}else{if(responseHeader.cve){var ejson=$(data).find("#taiji_ejson");var ejsonContent=$.parseJSON($(ejson).html());$("[generated=true]",$form).each(function(){$(this).html("");});$.each(ejsonContent,function(i,n){var $nextLabel=$("[for="+i+"]");if($nextLabel.hasClass($.Taiji.defaults.errorClass)){$nextLabel.text(n);$nextLabel.show();}else{$nextLabel=$("<label></label>");$nextLabel.addClass($.Taiji.defaults.errorClass);$nextLabel.attr({"for":i,generated:true});
$nextLabel.text(n);$("[name="+i+"]",$form).after($nextLabel);}});$.Taiji.showWarn($.Taiji.Messages.ERR_CVE);}else{if(xhr.status===200){var headStart=-1,headEnd=-1,head=$("head").html("")[0],tagList=["src","defer","language","type"],scriptStart=-1,tagIndex=-1,scriptEnd=-1,tagListLength=tagList.length,scriptText=[],scriptSrcText=[],aText,aAtt;while(data.indexOf("<script")>-1){scriptStart=data.indexOf("<script");tagIndex=data.indexOf(">");scriptEnd=data.indexOf("<\/script");var temp=data.substr(scriptStart,tagIndex);if(temp.indexOf("src")>0){scriptSrcText.push(data.substr(scriptStart,scriptEnd-scriptStart+9));}else{scriptText.push(data.substr(scriptStart,scriptEnd-scriptStart+9));}data=data.substr(0,scriptStart)+data.substr(scriptEnd+9);}var tagLength,start,end,text;while(data.indexOf("<head")>0){headStart=data.indexOf("<head");headEnd=data.indexOf("</head");var headHtml=data.substr(headStart,headEnd-headStart+7);$("head").append($(headHtml));data=data.substr(0,headStart)+data.substr(headEnd+7);
}$("body").html(data);window.setTimeout(function(){for(var a=0;a<scriptText.length;a++){aText=scriptText[a];tagIndex=aText.indexOf(">");aAtt=aText.substr(0,tagIndex);var aScript=document.createElement("script");aScript.type="text/javascript";head.appendChild(aScript);for(var i=0;i<tagListLength;i++){tagLength=tagList[i].length+1;if(aAtt.indexOf(tagList[i]+"=")>-1){start=aAtt.indexOf(tagList[i]+"=");end=aAtt.indexOf(aAtt.charAt(start+tagLength),start+tagLength+2);text=aAtt.substr(start+tagLength+1,end-start-tagLength-1);aScript[tagList[i]]=text;}}if(aText.length>tagIndex+1){aScript.text=aText.substr(tagIndex+1,aText.length-tagIndex-10);}}},100);}else{$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);}}}}}$button.attr("disabled",false);},error:function(xhr){$.Taiji.hideLoading();$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);$button.attr("disabled",false);},dataType:"html",forceSync:true};$.extend(settings,options);$(form).ajaxSubmit(settings);}});})(jQuery);(function($){$.Taiji.extendMethod({name:"multiOperate",event:{click:{"className":"_handleMultiOperateClick"}},eventHandler:{_handleMultiOperateClick:function(element){var $$this=this;
var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){$$this.warn("没有找到批量删除的URL..");return false;}if(!this.settings.multiCore.checkOne){$$this.warn("未设定checkbox的class");return false;}var $checkedList=$(this.settings.multiCore.checkOne+":checked");if($checkedList.size()===0){$$this.warn("未选中任何项");$.Taiji.showWarn("请至少选中一个操作项");return false;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if($$this.isRunning===true){$$this.warn("前一次<"+$$this.running+">操作尚未结束，当前multiOperate操作被禁止！");return false;}else{$$this.isRunning=true;}$this.attr("disabled",true);$.Taiji.showLoading("批量操作操作进行中，请稍等");var dataA="";var theCheckboxName=$checkedList.attr("name");$checkedList.each(function(){dataA+=theCheckboxName;dataA+="=";dataA+=$(this).val();dataA+="&";});if(dataA.length>1){dataA=dataA.substr(0,dataA.length-1);}$.ajax({url:$url,type:"POST",data:dataA,dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleMultiOperateSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}});},_handleMultiOperateSuccess:function(status,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);$.Taiji.hideLoading();this.isRunning=false;if(responseHeader.note){$.Taiji.showNote(this.decode(responseHeader.note));if(this.settings.multiOperate.callback&&typeof this.settings.multiOperate.callback==="function"){this.settings.multiOperate.callback(responseText);}$(this.currentTarget).trigger("taijiMultiOperateSuccess",[responseText]);}else{if(responseHeader.jme){$.Taiji.showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){$.Taiji.showWarn(this.decode(responseHeader.cve));}else{this.warn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);$.Taiji.showWarn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);}}}}}},afterSearchMethod:function(){var $$this=this;
$(this.settings.multiOperate.checkAllClassName,this.currentTarget).off("change.taiji").on("change.taiji",function(event){if($(this).is(":checked")){$(":input[name="+$$this.settings.multiOperate.checkboxName+"]",$$this.currentTarget).attr("checked",true);$($$this.settings.multiOperate.checkAllClassName,$$this.currentTarget).attr("checked",true);}else{$(":input[name="+$$this.settings.multiOperate.checkboxName+"]",$$this.currentTarget).attr("checked",false);$($$this.settings.multiOperate.checkAllClassName,$$this.currentTarget).attr("checked",false);}$.Taiji.preventDefault(event);});},config:{className:".taiji_multiOperate",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"multiRemove",event:{click:{"className":"_handleMultiRemoveClick"}},eventHandler:{_handleMultiRemoveClick:function(element){var $$this=this;var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){$$this.warn("没有找到批量删除的URL..");return false;}if(!this.settings.multiCore.checkOne){$$this.warn("未设定checkbox的class");
return false;}var $checkedList=$(this.settings.multiCore.checkOne+":checked");if($checkedList.size()===0){$.Taiji.showWarn("请至少选中一个操作项");return false;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return false;}else{this.isRunning=true;}$this.attr("disabled",true);$.Taiji.showLoading("批量删除操作进行中，请稍等");var dataA="";var theCheckboxName=$checkedList.attr("name");$checkedList.each(function(){dataA+=theCheckboxName;dataA+="=";dataA+=$(this).val();dataA+="&";});if(dataA.length>1){dataA=dataA.substr(0,dataA.length-1);}$.ajax({url:$url,type:"POST",data:dataA,dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleMultiRemoveSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}});},_handleMultiRemoveSuccess:function(status,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);$.Taiji.hideLoading();this.isRunning=false;if(responseHeader.note){var $checkedList=$(this.settings.multiCore.checkOne+":checked");var $size=$checkedList.size();$checkedList.each(function(i,v){$(this).parents("tr").remove();});$(".taiji_pager .totalcount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)-$size);});$.Taiji.showNote(this.decode(responseHeader.note));if(this.settings.multiRemove.callback&&typeof this.settings.multiRemove.callback==="function"){this.settings.multiRemove.callback(responseText);}$(this.currentTarget).trigger("taijiMultiRemoveSuccess",[responseText]);}else{if(responseHeader.jme){$.Taiji.showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(this.decode(responseHeader.me));
}else{if(responseHeader.cve){$.Taiji.showWarn(this.decode(responseHeader.cve));}else{this.warn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);$.Taiji.showWarn("服务器返回了非预期的值，请联系开发人员进行处理！,代码:",status);}}}}}},config:{className:".taiji_multiRemove",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"operate",event:{click:{"className":"_handleOperateClick"}},eventHandler:{_handleOperateSuccess:function(statusCode,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);$.Taiji.hideLoading();this.isRunning=false;if(responseHeader.note){if(this.settings.operate.callback&&typeof this.settings.operate.callback==="function"){this.settings.operate.callback(responseText);}$(this.currentTarget).triggerHandler("taijiOperateSuccess",[responseText]);$.Taiji.showNote(this.decode(responseHeader.note));}else{if(responseHeader.jme){$.Taiji.showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){$.Taiji.showWarn(this.decode(responseHeader.cve));
}else{this.warn($.Taiji.Messages.ERR_RESPONSE+statusCode);$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);}}}}},_handleOperateClick:function(element){var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};$$this._handleOperateSuccess(xhr.status,responseHeader,responseText,$this);
},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindOperate:function(){var $$this=this;$(this.settings.operate.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleOperateClick(this);});}},config:{className:".taiji_operate",callback:function(){}}});})(jQuery);(function($){$.extend({isSupportPlaceholder:(function(){return"placeholder" in document.createElement("input");})(),placeholderAll:function(){var inputs=$("input[placeholder]:visible");$.placeholder(inputs);var areas=$("textarea[placeholder]:visible");$.placeholder(areas);},placeholder:function(elems){if($.isSupportPlaceholder){return;}$(elems).each(function(){if($(this).is("[placeholder]")){var $offset=$(this).offset(),paddingLeft=$.getInt($(this).css("paddingLeft"))+$.getInt($offset.left)+2+"px",paddingTop=$.getInt($(this).css("paddingTop"))+$.getInt($offset.top)+2+"px",placeValue=$(this).attr("placeholder"),zindex=$(this).css("zIndex");var $span=$("<span class='taiji_placeholder'></span>").text(placeValue).css({left:paddingLeft,top:paddingTop});
$("body").after($span);var that=$(this);$span.on("click",function(){that.focus();});$(this).on("propertychange",function(){if($.trim($(that).val())===""){$span.show();}else{$span.hide();}}).addClass("_taiji_placeholder");}});},getInt:function(str){return window.parseInt(str,10);}});})(jQuery);jQuery(function(){jQuery.placeholderAll();});(function($){$.Taiji.extendMethod({name:"async",event:{click:{"className":"_handleAsyncClick"}},eventHandler:{_handleAsyncClick:function(element){var that=this;var $asyncConfig=$.extend({},{"interval":4000},$(element).metadata());var options={bsSuccess:function success(responseText){$.Taiji.showNote(responseText.msg);if($("#alert-progress").size()===0){window.setTimeout(function(){that._handleAsyncProcess($asyncConfig.process,$asyncConfig.interval);},1000);}}};this.ajaxHref(element,options);},_handleAsyncProcess:function($url,interval){var $this=this;$.ajax({url:$url,type:"POST",dataType:"json",success:function(responseText,status,xhr){var $alertProgress=$("#alert-progress");
if(responseText.processType==="SUCCESS"){$($this.currentTarget).triggerHandler("taijiAsyncSuccess",[responseText.result]);$alertProgress.remove();return;}var percent=Math.round(responseText.percent*100);if($alertProgress&&$alertProgress.size()===1){$(".progress-bar",$alertProgress).text(percent+"%").css({"width":percent+"%"});$("strong",$alertProgress).text(responseText.msg);}else{var html='<div id="alert-progress" class="alert alert-success  "  style="width:500px;display: block;">'+'<div class="progress progress-striped progress-lg active  m-t-5">'+'<div   class="progress-bar progress-bar-success"></div>'+"</div>"+"<strong></strong>"+"</div>";$alertProgress=$(html);$(".progress-bar",$alertProgress).text(percent+"%").css({"width":percent+"%","transition":"width "+interval/1000+"s linear 0s"});$("strong",$alertProgress).text(responseText.msg);$alertProgress.appendTo("body");}window.setTimeout(function(){$this._handleAsyncProcess($url,interval);},interval);}});}},config:{className:".taiji_async"}});
})(jQuery);(function($){$.Taiji.extendMethod({name:"collapse",event:{click:{"className":"_handleCollapseClick"}},eventHandler:{_handleCollapseClick:function(element){var a=$(element);var sibling=a.closest("tr").next();if(sibling.hasClass("collapse")){sibling.remove();return;}var options={method:"POST",bsSuccess:function(data){var tr,td,container;tr=$("<tr>").addClass("collapse in");td=$("<td>",{"colspan":a.closest("tr").children().length}).appendTo(tr);container=$("<div>",{"class":"well","html":$(data)}).appendTo(td);a.closest("tr").after(tr);}};this.ajaxHref(element,options);}},config:{className:".taiji_collapse"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"remove",event:{click:{"className":"_handleRemoveClick"}},eventHandler:{_handleRemoveClick:function(element){var $this=$(element);var options={method:"POST",bsSuccess:function(responseText,note){$this.parents("tr").remove();$(".taiji_pager .totalcount",this.currentTarget).each(function(){$(this).text(parseInt($(this).text(),10)-1);
});$.Taiji.showNote(note);$(this.currentTarget).triggerHandler("taijiRemoveSuccess",[responseText]);}};this.ajaxHref(element,options);}},config:{className:".taiji_remove"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"sortable",event:{click:{"className":"_handleSortableClick"}},eventHandler:{_handleSortableClick:function(element){var base=this;var $this=$(element);if(base.isRunning===true){base.warn($.Taiji.Messages.WAR_OPERATE);return;}var sortName="",sortType="false";if($.metadata){var md=$this.metadata();sortName=md.orderBy;if(!sortName){return;}sortType=md.desc;if($this.hasClass("taiji_asc")){$this.removeClass("taiji_asc").addClass("taiji_desc");sortType="true";}else{if($this.hasClass("taiji_desc")){$this.removeClass("taiji_desc").addClass("taiji_asc");sortType="false";}else{if(sortType===true){$this.addClass("taiji_desc");}else{$this.addClass("taiji_asc");}}}}else{return;}var sortable=base.settings.sortable;var search=base.settings.search;var $searchForm=$(search.formClassName,base.currentTarget);
var $sortName=$(base.currentTarget).find("input[name='orderBy']");if(!$sortName.val()){$sortName=$("<input type='hidden' name='orderBy'/>").appendTo($searchForm);}$sortName.val(sortName);var $sortType=$(base.currentTarget).find("input[name='desc']");if(!$sortType.val()){$sortType=$("<input type='hidden' name='desc'/>").appendTo($searchForm);}$sortType.val(sortType);$(base.searchSubmitClassName,base.currentTarget).trigger("click");}},config:{className:".taiji_sortable"}});})(jQuery);(function($){$.Taiji.extendMethod({name:"topOperate",event:{click:{"className":"_handleTopOperateClick"}},eventHandler:{_handleTopOperateSuccess:function(statusCode,responseHeader,responseText,obj){var $this=$(obj);$this.attr("disabled",false);$.Taiji.hideLoading();this.isRunning=false;if(responseHeader.note){if(this.settings.topOperate.callback&&typeof this.settings.topOperate.callback==="function"){this.settings.topOperate.callback(responseText);}$(this.currentTarget).triggerHandler("taijiTopOperateSuccess",[responseText]);
$.Taiji.showNote(this.decode(responseHeader.note));}else{if(responseHeader.jme){$.Taiji.showWarn(this.decode(responseHeader.jme));}else{if(responseHeader.me){$.Taiji.showWarn(this.decode(responseHeader.me));}else{if(responseHeader.cve){$.Taiji.showWarn(this.decode(responseHeader.cve));}else{this.warn($.Taiji.Messages.ERR_RESPONSE+statusCode);$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+statusCode);}}}}},_handleTopOperateClick:function(element){var $this=$(element);var $url=$.Taiji.getUrl($this);if(!$url){this.warn($.Taiji.Messages.ERR_URL);return;}var $message=$.Taiji.getConfirmMessage($this);if($message){if(!window.confirm($message)){return false;}}if(this.isRunning===true){this.warn($.Taiji.Messages.WAR_OPERATE);return;}else{this.isRunning=true;}$this.attr("disabled",true);$.Taiji.showLoading($.Taiji.Messages.MSG_OPERATE);var $$this=this;var options={url:$url,type:"POST",dataType:"html",success:function(responseText,status,xhr){var responseHeader={note:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_NOTE),jme:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_JME),me:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_ME),cve:xhr.getResponseHeader($.Taiji.Constans.RESPONSE_HEADER_CVE)};
$$this._handleTopOperateSuccess(xhr.status,responseHeader,responseText,$this);},error:function(xhr){$$this._handleOperateError(xhr.status,$this);}};$.ajax(options);},_bindTopOperate:function(){var $$this=this;$(this.settings.topOperate.className,this.currentTarget).off("click.taiji").on("click.taiji",function(event){$$this._handleTopOperateClick(this);$.Taiji.preventDefault(event);});}},config:{className:".taiji_topOperate",callback:function(){}}});})(jQuery);(function($){$.Taiji.extendMethod({name:"update",event:{click:{"className":"_handleUpdateClick"}},eventHandler:{_handleUpdateClick:function(element){var $this=$(element);var options={method:"POST",bsSuccess:function(responseText,note){this._handleBsSuccess(responseText,note,"update");}};this.ajaxHref(element,options);}},config:{className:".taiji_update"}});})(jQuery);(function($){$.fn.extend({isVisible:function(){if($(this).isChosenSelect()){return true;}return $(this).attr("type")!=="hidden"&&$(this).css("display")!=="none"&&$(this).css("visibility")!=="hidden";
},isChosenSelect:function(){return $(this).is("select")&&$(this).is(":hidden")&&$(this).next().is("div.chosen-container");},tjPopover:function(content,options){if(!content||!$(this).isVisible()){return;}var control=this;if(this.isChosenSelect()){control=this.next();}var errorEle=control.parent();errorEle.addClass("has-error");control.removeAttr("title").attr("data-content",content);control.popover({placement:"auto",trigger:"manual"}).popover("show").one("click.taiji focus.taiji",function(){$(this).popover("hide");var control=$(this);var errorEle=control.parent();errorEle.removeClass("has-error");});}});})(jQuery);(function($){$.fn.extend({showModal:function(opts){var defaults={size:"",complete:function(){}};var options=$.extend({},defaults,opts);if(this.length==0){return;}var $element=this.eq(0);var href=$element.attr("href");var $modalDialog=$("#modal-dialog");if($modalDialog.length==0){var templateModal='<div class="modal fade" id="modal-dialog">'+'<div class="modal-dialog">'+'<div class="modal-content">'+"</div>"+"</div>"+"</div>";
$modalDialog=$(templateModal).prependTo(document.body);$modalDialog.on("shown.bs.modal",function(){$.autocompleteAll();}).on("hidden.bs.modal",function(){$(this).removeClass("modal-message");$(this).find(".modal-dialog").removeClass("modal-lg").removeClass("modal-sm");$(this).find(".modal-content").empty();});}var dataObj={},method="GET";if($element.data("selector")){method="POST";$($element.data("selector")).each(function(){var e=$(this);if(e.attr("name")&&e.val()){var key=e.attr("name"),value=e.val();if(dataObj[key]){var oldVal=dataObj[key];if($.type(oldVal)=="array"){oldVal.push(value);}else{dataObj[key]=[];dataObj[key].push(oldVal);dataObj[key].push(value);}}else{dataObj[key]=value;}}});}if(options.data){method="POST";$.extend(dataObj,options.data);}$.ajax({type:method,url:href,data:dataObj,traditional:true,success:function(data){if(options.size=="modal-message"){$modalDialog.addClass(options.size);}else{$modalDialog.find(".modal-dialog").addClass(options.size);}$modalDialog.find(".modal-content").html(data);
$modalDialog.modal("show");},error:function(xhr){$.Taiji.showWarn($.Taiji.Messages.ERR_RESPONSE+xhr.status);},complete:function(xhr){options.complete.call($element);}});},hideModal:function(opts){var $modalDialog=$("#modal-dialog");if($modalDialog.hasClass("in")){$modalDialog.modal("hide");}}});})(jQuery);var tjUtils=tjUtils||{};(function($){$.extend(tjUtils,{toUpperCase:function(){$(this).val($(this).val().toUpperCase());},toLowerCase:function(){$(this).val($(this).val().toLowerCase());},scb2dbc:function(){var str=$(this).val(),result="";for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c===12888){result+=String.fromCharCode(32);}else{if(c>65280&&c<65375){result+=String.fromCharCode(c-65248);}else{result+=String.fromCharCode(c);}}}$(this).val(result);},toDbcUpperCase:function(){var str=$(this).val(),result="";for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c===12888){result+=String.fromCharCode(32);}else{if(c>65280&&c<65375){result+=String.fromCharCode(c-65248);}else{result+=String.fromCharCode(c);
}}}$(this).val(result.toUpperCase());},toDbcLowerCase:function(){var str=$(this).val(),result="";for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c===12888){result+=String.fromCharCode(32);}else{if(c>65280&&c<65375){result+=String.fromCharCode(c-65248);}else{result+=String.fromCharCode(c);}}}$(this).val(result.toLowerCase());}});})(jQuery);